<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kh.bookie.admin.model.dao.AdminDao">
	
	<insert id="insertAlarm">
		insert into
			alarm
		values(
			seq_alarm_no.nextval,
			#{memberId},
			#{alarmContent},
			default,
			sysdate
		)
	</insert>

	<select id="getUnreadCount" resultType="_int">
		select
			count(*)
		from
			alarm
		where
			member_id = #{memberId} and last_check = 0
	</select>
	
	<select id="selectReportList" resultType="report">
		select
			*
		from
			report
		order by
			created_at desc
	</select>
	
	<select id="selectReportListByCategory" resultType="report">
		select
			*
		from
			report
		where
			category = #{category}
		order by
			created_at desc
	</select>
	
	<select id="selectReportListByStatus" resultType="report">
		select
			*
		from
			report
		where
			status = #{status}
		order by
			created_at desc
	</select>
	
	<select id="selectReportListByBoth" resultType="report">
		select
			*
		from
			report
		where
			status = #{status} and category = #{category}
		order by
			created_at desc
	</select>
	
	<select id="selectOneReport" resultType="report">
		select
			*
		from
			report
		where
			report_no = #{reportNo}
	</select>
	
	<update id="reportUpdate">
		update
			report
		set
			status = #{status},
			updatedAt = sysdate
		where
			report_no = #{reportNo}
	</update>
</mapper>